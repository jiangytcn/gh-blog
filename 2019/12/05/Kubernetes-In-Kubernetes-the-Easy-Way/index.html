<!DOCTYPE html>
<html class="has-navbar-fixed-top">
<head>
    <meta charset="utf-8">
<title>Kubernetes In Kubernetes the Easy Way - ystacks</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">








    <meta name="description" content="If you are planing to adopt CloudNative way to ship your products in an efficient way, then Kubernetes might be a good choice to mondernize IT.After serveral years growth, the product went into an sta">
<meta name="keywords" content="OpenStack,Kubernetes,CloudNative,MultiCloud">
<meta property="og:type" content="article">
<meta property="og:title" content="Kubernetes In Kubernetes the Easy Way">
<meta property="og:url" content="http:&#x2F;&#x2F;www.ystacks.com&#x2F;2019&#x2F;12&#x2F;05&#x2F;Kubernetes-In-Kubernetes-the-Easy-Way&#x2F;index.html">
<meta property="og:site_name" content="ystacks">
<meta property="og:description" content="If you are planing to adopt CloudNative way to ship your products in an efficient way, then Kubernetes might be a good choice to mondernize IT.After serveral years growth, the product went into an sta">
<meta property="og:locale" content="en">
<meta property="og:image" content="http:&#x2F;&#x2F;www.ystacks.com&#x2F;images&#x2F;cncf-certified-k8s-installer.png">
<meta property="og:image" content="http:&#x2F;&#x2F;www.ystacks.com&#x2F;images&#x2F;gardener-dashboard-clusters.png">
<meta property="og:updated_time" content="2019-12-06T08:47:06.939Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http:&#x2F;&#x2F;www.ystacks.com&#x2F;images&#x2F;cncf-certified-k8s-installer.png">





<link rel="icon" href="/favicon.png">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/css/justifiedGallery.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">

<link rel="stylesheet" href="/css/style.css">

<script defer src="//use.fontawesome.com/releases/v5.0.8/js/all.js"></script>


    
    
    
    
    
    
    
    
    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-158694874-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-158694874-1');
</script>


    


    <script data-ad-client="ca-pub-3340970368261712" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

</head>
<body>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/">
                
                    
                    ystacks
                    
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item "
               href="/archives">Archives</a>
            
            <a class="navbar-item "
               href="/tags">Tags</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            <a class="navbar-item search" title="Search" href="javascript:;" target="_blank" rel="noopener">
                <i class="fas fa-search"></i>
            </a>
            
            
            
            <a class="navbar-item" title="GitHub" href="https://github.com/jiangytcn" target="_blank" rel="noopener">
                
                <i class="fab fa-github"></i>
                
            </a>
               
            
        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            Kubernetes In Kubernetes the Easy Way
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2019-12-05T14:09:00.000Z" itemprop="datePublished">Dec 5 2019</time>
        </span>
        
        
        <span class="column is-narrow">
            
            
            8 minutes read (About 1231 words)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <p>If you are planing to adopt CloudNative way to ship your products in an efficient way, then <a href="https://kubernetes.io/" target="_blank" rel="noopener">Kubernetes</a> might be a good choice to mondernize IT.After serveral years growth, the product went into an stable state and adpoted by large number of companies in Production environments. All major cloud prvoider players offerred their own kubernretes service with their own addons. Kelsey Hightower wrote an good article <a href="https://github.com/kelseyhightower/kubernetes-the-hard-way" target="_blank" rel="noopener">Kubernetes-the-hard-way</a> to help you better understanding the tasks needed to deploy a workable kubernetes cluster. The minimal tasks needed are:</p>
<a id="more"></a>
<ol>
<li>container engine installation</li>
<li>networking plugin installation</li>
<li>certificate management and distribution</li>
<li>storage backend management</li>
<li>components configuration, apiserver, controller, scheduller, …</li>
</ol>
<p>More steps would be added to the the configureation pipelines as more features needed. To expose your service can be accessed publicly, you need to deploy a ingress service, to host a stateful service, for example, for a 3 tiers architecture, you need to deploy a database in the cluster, then cames the CSI compoennts.</p>
<p>So, how can I get my own kubernetes based platform in an easy and efficient way ? how can I have multiple clusters with mimimal resources needed ? and how to keep up with the relases provided by the community to address the CVE, Bug Fix or new feature needed ? </p>
<p>There are so many deployment tools around the kubenetes, and from CNCF there’re couple of <a href="https://landscape.cncf.io/category=certified-kubernetes-installer&format=card-mode&grouping=category" target="_blank" rel="noopener">certified installers</a> to help your spin up and manage kuberntes cluster.</p>
<p><img src="/images/cncf-certified-k8s-installer.png" alt="cncf certified k8s installer"></p>
<p>From all of these tools, the uniqueness of <a href="https://gardener.cloud/" target="_blank" rel="noopener">Gardener</a> is that the kubernets can be managed by kubernetes, fully utilized the benefit of kubernetes, CustomResource, Deployment, Ingress, etc</p>
<p><em>want to upgrade a new version of kubernetes cluster?</em> that’s easy, just use the webgui or with kubectl same as manage normal kube resource;</p>
<p><em>want to reduce the resources occupied by the control plane of kubernetes?</em> that’s easy, all end user kubernets cluster’s control plane would be running as pod;</p>
<p><em>want to have a consistent deployment and fine gained control accross your different kubernets?</em> that’s easy, gardener using Terraform and couple extensions to help you manage the resource deployed and configured; no human interaction;</p>
<h3 id="So-how-to-setup-in-my-environment"><a href="#So-how-to-setup-in-my-environment" class="headerlink" title="So, how to setup in my environment ?"></a>So, how to setup in my environment ?</h3><p>here’s my environment and all components setting, basically, you need to have an workable IaaS, a existed kubernetes cluster to host all gardener components, A DNS service to manage the records created for ingress services, and load balancer service which can be used for your kubernetes cloud provider.Lastly, need to have an object storeage to store the backups for resilence.</p>
<table>
<thead>
<tr>
<th>Compoents</th>
<th>Version</th>
<th>Note</th>
</tr>
</thead>
<tbody><tr>
<td>IaaS - OpenStack</td>
<td>stable/rocky</td>
<td>The OpenStack IaaS is setup in my home lab environment backed by a 64G E5-2660 V2 DIY server, installed and configured with <a href="https://git.openstack.org/openstack/openstack-ansible" target="_blank" rel="noopener">openstack-ansible</a></td>
</tr>
<tr>
<td>DNS - OpenStack-Designate</td>
<td>stable/rocky</td>
<td>along side the designate, hosted <a href="https://coredns.io/" target="_blank" rel="noopener">CoreDNS</a> as a DNS proxy, this is optional, just for debugging DNS related issue and to answer the requests outside the openstack environment</td>
</tr>
<tr>
<td>LbaaS - OpenStack Haproxy based</td>
<td>stable/rocky</td>
<td></td>
</tr>
<tr>
<td>Base Cluster – K8S</td>
<td>1.16.2</td>
<td>Base K8S Cluster is setup with <a href="https://github.com/kubernetes-sigs/kubespray.git" target="_blank" rel="noopener">kubespray</a> and my patch for fixing the etcd issue, my <a href="https://github.com/kubernetes-sigs/kubespray/pull/5368" target="_blank" rel="noopener">PR</a> is not merged by community yet, so apply it if you had same <a href="https://github.com/kubernetes-sigs/kubespray/issues/4772" target="_blank" rel="noopener">issue</a></td>
</tr>
<tr>
<td>Gardener - <a href="https://github.com/gardener/garden-setup" target="_blank" rel="noopener">garden-setup</a></td>
<td>1.17.0</td>
<td></td>
</tr>
</tbody></table>
<p>Before start the journey to expore Gardener, couples things need to configured correctly otherwise you will be failed to install gardener. </p>
<ol>
<li>The base kubernetes cluster  network CNI configuration.<br>If your’re using calico as the network cni for the undercloud cluster, the mtu need to be set correctly, otherwise the gardener components won’t connecte with each other correctly. choose approiate value per the guidance from <a href="https://docs.projectcalico.org/v3.10/networking/mtu" target="_blank" rel="noopener">calico networking MTU Configuration</a> based on your own environment. For me, the cluster setup with IPIP mode and no jumboframe configured in my switch, so its <code>1430</code></li>
<li>the images can be used in gardener.<br>After couple hours debugging and supported by gardener community, only a subset images supported by the installation miscs in Gardener, I only tried CoreOS and Ubuntu, gardener itself supported other os distributions, but no judgement about the compatibilities of other oses.<table>
<thead>
<tr>
<th>OS</th>
<th>Version</th>
<th>Compatible</th>
</tr>
</thead>
<tbody><tr>
<td>Ubuntu</td>
<td>18.04</td>
<td>Y</td>
</tr>
<tr>
<td>Ubuntu</td>
<td>16.04</td>
<td>X</td>
</tr>
<tr>
<td>CoreOS</td>
<td>2135.6.0</td>
<td>Y</td>
</tr>
<tr>
<td>CoreOS</td>
<td>2023.5.0</td>
<td>X</td>
</tr>
</tbody></table>
</li>
</ol>
<p><strong>the image used for kubernetes worker nodes need to be uploaded to IaaS before the gardener installation start, it won’t download the image for you</strong></p>
<ol start="3">
<li>OpenStack API Access reachable from your kube cluster.<br>Gardener using terrafrom to create resources on demand in your OpenStack environment, so need to make your IaaS reachable from the pods running in the kubernete cluster, dns, routing, etc.</li>
</ol>
<h3 id="Installation-under-OpenStack"><a href="#Installation-under-OpenStack" class="headerlink" title="Installation under OpenStack"></a>Installation under OpenStack</h3><p>The installation steps is easy, providing the configuration file named <code>acre.yml</code> with correct setting along side a single command, that’s it!</p>
<p>You can follow this <a href="https://github.com/gardener/garden-setup/blob/1.17.0/README.md" target="_blank" rel="noopener">guide</a> to start the deployment, the processes are running under docker container. If you want to run that under your desktop to see how the majic happened, get the necessary tools from <a href="https://github.com/gardener/sow/blob/master/docker/Dockerfile" target="_blank" rel="noopener">SOW Dockerfile</a> and configure <code>PATH</code> correctly.</p>
<p>The basic steps are:</p>
<ol>
<li>get your base kubernetes kubeconfig file</li>
<li>configure <code>acre.yaml</code> correctly</li>
<li>verify the configuration by <code>sow order -A</code></li>
<li>deploy the gardener by <code>sow deploy -A</code></li>
<li>access the gardener builtin ui by <code>sow url</code></li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">credentials: &amp;openstack</span><br><span class="line">  username: admin</span><br><span class="line">  password: ae226d1f8b27c60b31088</span><br><span class="line">  tenantName: admin</span><br><span class="line">  domainName: Default</span><br><span class="line">  userDomainName: Default</span><br><span class="line">  authURL: https://api.int.ystacks.com:5000/v3</span><br><span class="line">  region: RegionOne</span><br><span class="line">  bucketName: gardener</span><br><span class="line">landscape:</span><br><span class="line">  name: overcloud-caas-ystacks-com</span><br><span class="line">  domain: overcloud.caas.ystacks.com</span><br><span class="line">  cluster:</span><br><span class="line">    kubeconfig: ./kubeconfig</span><br><span class="line">    domain: overcloud.caas.ystacks.com</span><br><span class="line">    iaas: openstack</span><br><span class="line">    networks:</span><br><span class="line">      pods: 10.44.0.0/15</span><br><span class="line">      nodes: 10.132.0.0/16</span><br><span class="line">      services: 10.233.10.0/24 # change to under actual undercloud service ip cidr</span><br><span class="line">  iaas:</span><br><span class="line">    - name: openstack</span><br><span class="line">      type: openstack</span><br><span class="line">      mode: seed</span><br><span class="line">      region: RegionOne</span><br><span class="line">      zones:</span><br><span class="line">      - nova</span><br><span class="line">      credentials: *openstack</span><br><span class="line">      floatingPools:</span><br><span class="line">      - name: public</span><br><span class="line">      loadBalancerProviders:</span><br><span class="line">      - name: haproxy</span><br><span class="line">      extensionConfig:</span><br><span class="line">        machineImages:</span><br><span class="line">        - cloudProfiles:</span><br><span class="line">          - image: coreos-2135.6.0</span><br><span class="line">            name: openstack       # A</span><br><span class="line">          name: coreos              # B</span><br><span class="line">          version: 2135.6.0         # C</span><br><span class="line">        - cloudProfiles:</span><br><span class="line">          - image: ubuntu-18.04</span><br><span class="line">            name: openstack       # A</span><br><span class="line">          name: ubuntu              # B</span><br><span class="line">          version: &quot;18.04&quot;        # C</span><br><span class="line">      machineImages:</span><br><span class="line">        - name: coreos</span><br><span class="line">          versions:</span><br><span class="line">          - version: 2135.6.0</span><br><span class="line">        - name: openstack</span><br><span class="line">          versions:</span><br><span class="line">          - version: &quot;18.04&quot;</span><br><span class="line">      machineTypes:</span><br><span class="line">        - name: 2C4G50G</span><br><span class="line">          cpu: &quot;2&quot;</span><br><span class="line">          gpu: &quot;0&quot;</span><br><span class="line">          memory: 4Gi</span><br><span class="line">          usable: true</span><br><span class="line">          storage:</span><br><span class="line">            class: default</span><br><span class="line">            type: default</span><br><span class="line">            size: 50Gi</span><br><span class="line">        - name: 4C8G50G</span><br><span class="line">          cpu: &quot;4&quot;</span><br><span class="line">          gpu: &quot;0&quot;</span><br><span class="line">          memory: 8Gi</span><br><span class="line">          usable: true</span><br><span class="line">          storage:</span><br><span class="line">            class: default</span><br><span class="line">            type: default</span><br><span class="line">            size: 50Gi</span><br><span class="line">  etcd:</span><br><span class="line">    backup:</span><br><span class="line">      type: swift</span><br><span class="line">      credentials: *openstack</span><br><span class="line">  dns:</span><br><span class="line">    type: openstack-designate</span><br><span class="line">    credentials: *openstack</span><br><span class="line">  identity:</span><br><span class="line">    users:</span><br><span class="line">      - email: jiangyt.cn@gmail.com</span><br><span class="line">        username: jiangyt.cn@gmail.com</span><br><span class="line">        password: password</span><br></pre></td></tr></table></figure>



<p>After deploy you gardener cluster, accessing <code>sow url</code> to visit gardener dashboard and login with the user provided in identity above</p>
<p><img src="/images/gardener-dashboard-clusters.png" alt="Gardener Dashboard after logon in cluster view"></p>
<p><em>Note:created two clusters by gardener with different kubernetes versions</em></p>
<h3 id="Useful-Commands"><a href="#Useful-Commands" class="headerlink" title="Useful Commands"></a>Useful Commands</h3><h4 id="Edit-Machine-Image-and-Type-on-the-fly"><a href="#Edit-Machine-Image-and-Type-on-the-fly" class="headerlink" title="Edit Machine Image and Type on the fly"></a>Edit Machine Image and Type on the fly</h4><p>The machine image versions and types are stored as CR in the seed kube-apiserver, so targetting the seed kube virtual cluster with exported kubeconfig file to edit resources</p>
<blockquote>
<ol>
<li>kubectl –kubeconfig export/kube-apiserver/kubeconfig edit controllerregistration.core.gardener.cloud/provider-openstack</li>
<li>kubectl –kubeconfig export/kube-apiserver/kubeconfig edit cloudprofiles/openstack</li>
</ol>
</blockquote>

    
    </div>
    
    <div class="columns is-variable is-1 is-multiline is-mobile">
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/OpenStack/">#OpenStack</a></span>
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/Kubernetes/">#Kubernetes</a></span>
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/CloudNative/">#CloudNative</a></span>
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/MultiCloud/">#MultiCloud</a></span>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop  article-nav-prev">
            
            <a href="/2020/01/01/Jenkins-X-Development-101/">Jenkins-X-Development-101</a>
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="/2019/11/06/pfsense-tcp-offloading-kvm-virtio/">pFsense tcp offloading in kvm virtio</a>
            
        </span>
    </div>
    
</article>


<div class="sharebox">
    
<div class="addthis_inline_share_toolbox"></div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5d311cd182d75784"></script>

</div>



<div class="comments">
    <h3 class="title is-4">Comments</h3>
    
<script>
    var disqus_config = function () {
        this.page.url = 'http://www.ystacks.com/2019/12/05/Kubernetes-In-Kubernetes-the-Easy-Way/';
        this.page.identifier = '2019/12/05/Kubernetes-In-Kubernetes-the-Easy-Way/';
        
        this.language = 'en';
        
    };
    (function() {
        var d = document, s = d.createElement('script');  
        s.src = '//' + 'ystacks' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

<div id="disqus_thread">
    
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</div>

    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2020 Jiang Yi Tao&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            
        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script>

<!-- test if the browser is outdated -->
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/" target="_blank" rel="noopener">Update my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js"></script>
<script>
    $(document).ready(function () {
        // plugin function, place inside DOM ready function
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        })
    });
</script>

<script>
    window.FontAwesomeConfig = {
        searchPseudoElements: true
    }
    moment.locale("en-AU");
</script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        "HTML-CSS": {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
</script>

    
    
    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/js/jquery.justifiedGallery.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof($.fn.justifiedGallery) === 'function') {
                $('.justified-gallery').justifiedGallery();
            }
        });
    })(jQuery);
</script>

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <style>
        .hljs {
            position: relative;
        }

        .hljs .clipboard-btn {
            float: right;
            color: #9a9a9a;
            background: none;
            border: none;
            cursor: pointer;
        }

        .hljs .clipboard-btn:hover {
          color: #8a8a8a;
        }

        .hljs > .clipboard-btn {
            display: none;
            position: absolute;
            right: 4px;
            top: 4px;
        }

        .hljs:hover > .clipboard-btn {
            display: inline;
        }

        .hljs > figcaption > .clipboard-btn {
            margin-right: 4px;
        }
    </style>
    <script>
      $(document).ready(function () {
        $('figure.hljs').each(function(i, figure) {
          var codeId = 'code-' + i;
          var code = figure.querySelector('.code');
          var copyButton = $('<button>Copy <i class="far fa-clipboard"></i></button>');
          code.id = codeId;
          copyButton.addClass('clipboard-btn');
          copyButton.attr('data-clipboard-target-id', codeId);

          var figcaption = figure.querySelector('figcaption');

          if (figcaption) {
            figcaption.append(copyButton[0]);
          } else {
            figure.prepend(copyButton[0]);
          }
        })

        var clipboard = new ClipboardJS('.clipboard-btn', {
          target: function(trigger) {
            return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
          }
        });
        clipboard.on('success', function(e) {
          e.clearSelection();
        })
      })
    </script>

    
    

    


<script src="/js/script.js"></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-mask"></div>
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js"></script>
    
</body>
</html>